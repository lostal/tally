---
// App URL for links - defaults to localhost:3000 in development
const appUrl = import.meta.env.PUBLIC_APP_URL || 'http://localhost:3000';
---

<header
  class="bg-cream/90 fixed top-0 right-0 left-0 z-50 border-b border-stone-200 backdrop-blur-md transition-all duration-300"
>
  <div class="px-6 md:px-8 lg:px-12">
    <div class="flex items-center justify-between py-4 md:py-6">
      <!-- Logo -->
      <a href="/" class="text-title font-serif">
        tally<span class="text-tomato">.</span>
      </a>

      <!-- Navigation Desktop -->
      <nav class="hidden items-center gap-6 lg:flex lg:gap-8">
        <a href="#features" class="text-body text-muted hover:text-warm-black transition-colors"
          >Producto</a
        >
        <a href="/precios" class="text-body text-muted hover:text-warm-black transition-colors"
          >Precios</a
        >
        <a href="/demo" class="text-body text-muted hover:text-warm-black transition-colors">Demo</a
        >
      </nav>

      <!-- CTA Button -->
      <div class="flex items-center gap-4">
        <a
          href={`${appUrl}/register`}
          class="btn !text-warm-black !border-warm-black hover:!bg-warm-black hover:!text-cream hidden !bg-transparent text-sm sm:inline-flex"
        >
          Empezar gratis
        </a>
        <button
          class="lg:hidden"
          id="mobile-menu-btn"
          aria-label="Abrir menÃº"
          aria-expanded="false"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <line x1="3" y1="12" x2="21" y2="12"></line>
            <line x1="3" y1="6" x2="21" y2="6"></line>
            <line x1="3" y1="18" x2="21" y2="18"></line>
          </svg>
        </button>
      </div>
    </div>

    <!-- Mobile Menu -->
    <div class="hidden pb-6 lg:hidden" id="mobile-menu">
      <nav class="flex flex-col gap-4">
        <a
          href="#features"
          class="text-body text-muted hover:text-warm-black py-2 transition-colors">Producto</a
        >
        <a href="/precios" class="text-body text-muted hover:text-warm-black py-2 transition-colors"
          >Precios</a
        >
        <a href="/demo" class="text-body text-muted hover:text-warm-black py-2 transition-colors"
          >Demo</a
        >
        <a
          href={`${appUrl}/register`}
          class="btn !text-warm-black !border-warm-black hover:!bg-warm-black hover:!text-cream mt-4 w-full justify-center !bg-transparent"
        >
          Empezar gratis
        </a>
      </nav>
    </div>
  </div>
</header>

<style>
  header {
    transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
  }

  header.scrolled {
    box-shadow: 0 2px 20px rgba(0, 0, 0, 0.05);
    padding-top: 0.25rem;
    padding-bottom: 0.25rem;
  }

  #mobile-menu {
    transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
  }

  #mobile-menu.open {
    display: flex;
  }
</style>

<script>
  const mobileMenuBtn = document.getElementById('mobile-menu-btn');
  const mobileMenu = document.getElementById('mobile-menu');

  if (mobileMenuBtn && mobileMenu) {
    mobileMenuBtn.addEventListener('click', () => {
      mobileMenu.classList.toggle('open');
      const isOpen = mobileMenu.classList.contains('open');
      mobileMenuBtn.setAttribute('aria-expanded', String(isOpen));
    });
  }

  // Close mobile menu on link click
  const mobileLinks = mobileMenu?.querySelectorAll('a');
  mobileLinks?.forEach((link) => {
    link.addEventListener('click', () => {
      mobileMenu?.classList.remove('open');
      mobileMenuBtn?.setAttribute('aria-expanded', 'false');
    });
  });
</script>
